Good. Weâ€™ll keep it technically solid but natural â€” like a serious UG research paper, not a journal trying too hard.

Weâ€™ll stick to **Option B: Hybrid GRUâ€“Kalman Observer for Timely Flight Data Recovery**.

---

# âœ… Rewritten ABSTRACT (Clean, Technical, Student Tone)

**ABSTRACT**

Timely recovery of flight data plays a critical role in post-accident investigation and real-time flight monitoring. In long-range operations, especially over oceanic regions, transmission of flight data (TFD) through satellite or RF links is constrained by limited bandwidth, transmission cost, and intermittent connectivity. As a result, the received data at ground stations may be quantized, noisy, or incomplete. Classical state estimation techniques such as Kalman filtering rely heavily on accurate physical models and Gaussian noise assumptions, which may not hold under such degraded communication conditions.

This paper proposes a hybrid estimation framework combining a physics-based Kalman Filter (KF) with a data-driven Gated Recurrent Unit (GRU) network for longitudinal state and disturbance reconstruction of a Boeing 747 aircraft model. The KF performs model-based prediction, while the GRU learns temporal patterns in the innovation sequence to estimate gust disturbances and compensate for model mismatch. The proposed approach leverages both the interpretability of model-based observers and the adaptability of recurrent neural networks. Simulation studies under gust excitation, packet dropouts, and measurement noise demonstrate improved state recovery accuracy compared to standalone KF estimation. The results suggest that hybrid recurrent observers can enhance robustness of flight data recovery in bandwidth-limited transmission environments.

---

# âœ… Rewritten INTRODUCTION (Structured and Natural)

**1. INTRODUCTION**

Accurate reconstruction of flight parameters is essential for flight safety analysis, accident investigation, and real-time monitoring of aircraft performance. Modern aircraft increasingly rely on Transmission of Flight Data (TFD) systems to stream selected parameters from onboard sensors to ground-based monitoring systems. However, long-distance satellite communication channels are inherently bandwidth-limited and costly. As a result, transmitted data is often compressed, quantized, or intermittently lost, leading to incomplete or degraded flight information at the receiver side.

Traditional estimation techniques in aerospace applications are predominantly model-based. Methods such as the Output Error Method (OEM), Filter Error Method (FEM), and Kalman Filtering frameworks rely on known system dynamics and statistical noise assumptions. While these methods perform well under ideal measurement conditions, their performance deteriorates when the received data contains packet dropouts, non-Gaussian disturbances, or unmodeled aerodynamic effects such as gusts.

In longitudinal aircraft dynamics, environmental disturbances like wind gusts introduce structured bias into the system states. When the ground-based estimator does not explicitly model these disturbances, the innovation sequence of the Kalman Filter becomes temporally correlated rather than white. This indicates the presence of information not captured by the physics model.

To address this limitation, this work proposes a hybrid observer that integrates a model-based Kalman Filter with a Gated Recurrent Unit (GRU) network. The Kalman Filter provides physics-consistent state prediction, while the GRU learns the temporal structure of the innovation sequence to estimate gust disturbances and compensate for modeling errors. By combining model knowledge with learned temporal correction, the proposed framework aims to improve robustness of flight data recovery under degraded transmission conditions.

The study focuses on the discrete-time longitudinal dynamics of a Boeing 747 aircraft modeled with five states: forward velocity, vertical velocity, pitch rate, pitch angle, and altitude. The proposed hybrid architecture is evaluated using simulated flight data under gust excitation and measurement noise.

---

Thatâ€™s clean. No unnecessary textbook lecture. Clear problem â†’ gap â†’ solution.

---

# âœ… Now Your Flow Diagram (Control-System Style)

Below is your **final hybrid structure**, written like a control block diagram.

---

## ğŸ”· HYBRID GRUâ€“KF OBSERVER ARCHITECTURE

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 Control Input u_k â”€â–¶  True Aircraft Model       â”‚
                    â”‚  x_{k+1}=A x + B u + B_w g â”‚
 Gust g_k â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶                            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                        Measurement y_k
                               â”‚
                               â–¼
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚   Ground-Based Physics Model   â”‚
               â”‚  (No gust term in prediction)  â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                 Kalman Prediction Step
                 xÌ‚_{k|k-1} = A xÌ‚ + B u
                          â”‚
                          â–¼
              Innovation: yÌƒ_k = y_k - C xÌ‚_{k|k-1}
                          â”‚
                          â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚ Innovation Buffer (Window N)â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚      GRU       â”‚
                 â”‚ Learns gust &  â”‚
                 â”‚ model mismatch â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                Estimated Gust Ä_k
                          â”‚
                          â–¼
         Corrected Prediction:
         xÌ‚_corr = xÌ‚_{k|k-1} + B_w Ä_k
                          â”‚
                          â–¼
                 Kalman Update Step
                          â”‚
                          â–¼
                   Final State Estimate
```

---

# ğŸ”· Mathematical Flow Summary

Prediction:
[
\hat{x}*{k|k-1} = A_d \hat{x}*{k-1|k-1} + B_d u_k
]

Innovation:
[
\tilde{y}*k = y_k - C \hat{x}*{k|k-1}
]

GRU learns:
[
\hat{g}*k = f*{GRU}(\tilde{y}_{k-N+1:k})
]

Correction:
[
\hat{x}*{k|k-1}^{corr} = \hat{x}*{k|k-1} + B_w \hat{g}_k
]

Update:
Standard Kalman update using corrected prediction.

---

# ğŸ¯ What Makes This Strong

* Physics handles short-term prediction.
* GRU handles temporal correlation in residual.
* Gust becomes a learned disturbance.
* Innovation becomes information-rich signal.

Thatâ€™s the core story.

---

Later we can:

* Formalize stability discussion
* Add confidence weighting block
* Write patent-style claim language
* Design training algorithm section

For now, this gives you:

âœ” Clean abstract
âœ” Structured introduction
âœ” Proper system architecture
âœ” Clear mathematical flow

When you're ready, we go deeper.


Excellent. Now we go deep â€” properly mathematical and structural. No summaries, no bullet shortcuts. Just theory and derivation.

I will expand three things rigorously:

1. Innovation structure under unmodeled gust
2. Temporal correlation and why linear KF fails
3. Full hybrid observer as a coupled nonlinear dynamical system

---

# 4. Innovation Structure Under Unmodeled Gust Disturbance

Consider the true system:

[
x_{k+1} = A_d x_k + B_d u_k + B_w g_k + w_k
]

[
y_k = C x_k + v_k
]

The ground estimator neglects the gust term:

[
\hat{x}*{k+1|k} = A_d \hat{x}*{k|k} + B_d u_k
]

Define the estimation error:

[
e_k = x_k - \hat{x}_{k|k-1}
]

Substituting true and predicted dynamics:

[
e_{k+1} =
A_d x_k + B_d u_k + B_w g_k + w_k
---------------------------------

A_d \hat{x}_{k|k}

* B_d u_k
  ]

[
e_{k+1} =
A_d (x_k - \hat{x}_{k|k}) + B_w g_k + w_k
]

Since

[
x_k - \hat{x}_{k|k}
===================

(I - K_k C)(x_k - \hat{x}_{k|k-1}) - K_k v_k
]

the complete error recursion becomes:

[
e_{k+1} =
A_d (I - K_k C)e_k

* B_w g_k
* w_k

- A_d K_k v_k
  ]

This equation shows that the estimation error evolves as a linear system forced by:

* Gust disturbance (g_k)
* Process noise (w_k)
* Measurement noise (v_k)

Now define innovation:

[
\tilde{y}*k = y_k - C\hat{x}*{k|k-1}
]

Substitute measurement:

[
\tilde{y}*k =
C x_k + v_k - C\hat{x}*{k|k-1}
]

[
\tilde{y}_k =
C e_k + v_k
]

Thus the innovation is directly proportional to the state estimation error.

Substituting error recursion into innovation dynamics:

[
\tilde{y}_{k+1}
===============

C A_d (I - K_k C)e_k

* C B_w g_k
* C w_k

- C A_d K_k v_k

* v_{k+1}
  ]

This expression reveals something fundamental:

If gust (g_k) is persistent and time-correlated, then innovation is also time-correlated.

Therefore, innovation is no longer white.

Kalman filter optimality assumes:

[
E[\tilde{y}*k \tilde{y}*{k-j}^T] = 0, \quad j \neq 0
]

But here,

[
E[\tilde{y}_{k+1}\tilde{y}_k^T]
\neq 0
]

due to disturbance term (C B_w g_k).

Thus the innovation sequence contains hidden deterministic structure driven by gust dynamics.

This is the mathematical justification for learning from innovation.

---

# 5. Temporal Correlation and Residual Dynamics

Assume gust follows first-order stochastic process:

[
g_{k+1} = F_g g_k + \eta_k
]

where (F_g) represents gust persistence and (\eta_k) is white excitation.

Substitute into error recursion:

[
e_{k+1} =
A_e e_k + B_w g_k + noise
]

with

[
A_e = A_d (I - K_k C)
]

Stack error and gust:

[
\begin{bmatrix}
e_{k+1} \
g_{k+1}
\end{bmatrix}
=============

\begin{bmatrix}
A_e & B_w \
0 & F_g
\end{bmatrix}
\begin{bmatrix}
e_k \
g_k
\end{bmatrix}
+
\text{noise}
]

Innovation becomes:

[
\tilde{y}_k =
\begin{bmatrix}
C & 0
\end{bmatrix}
\begin{bmatrix}
e_k \
g_k
\end{bmatrix}

* v_k
  ]

This is effectively an augmented hidden-state system.

However, ground KF does not estimate (g_k).

Thus innovation acts as a partial measurement of an unobserved augmented system.

The GRUâ€™s task is to approximate the mapping:

[
{\tilde{y}_{k-N+1}, ..., \tilde{y}_k}
\rightarrow g_k
]

This is a nonlinear observer identification problem.

---

# 6. GRU as Nonlinear Observer Approximation

A GRU can be viewed as a nonlinear state observer:

[
h_k = \Phi(h_{k-1}, \tilde{y}_k)
]

[
\hat{g}_k = \Psi(h_k)
]

where:

[
\Phi(\cdot)
===========

(1 - z_k)\odot h_{k-1}
+
z_k \odot
\tanh(W_h \tilde{y}*k + U_h (r_k \odot h*{k-1}))
]

The hidden state (h_k) acts as internal memory approximating the latent gust state.

Unlike linear augmentation, GRU learns:

* Nonlinear mapping
* Time-varying disturbance statistics
* Transmission-induced correlation

Thus, GRU acts as a nonlinear disturbance observer.

---

# 7. Coupled Hybrid Observer Dynamics

Define corrected prediction:

[
\hat{x}_{k|k-1}^{corr}
======================

\hat{x}_{k|k-1}
+
B_w \hat{g}_k
]

The final update becomes:

[
\hat{x}_{k|k}
=============

\hat{x}_{k|k-1}
+
B_w \hat{g}*k
+
K_k (y_k - C\hat{x}*{k|k-1})
]

Rearranging:

[
\hat{x}_{k|k}
=============

A_d \hat{x}_{k-1|k-1}
+
B_d u_k
+
B_w \hat{g}_k
+
K_k \tilde{y}_k
]

Now substitute innovation:

[
\hat{x}_{k|k}
=============

A_d \hat{x}_{k-1|k-1}
+
B_d u_k
+
B_w \hat{g}_k
+
K_k (C e_k + v_k)
]

Therefore, the complete hybrid observer is a nonlinear dynamical system:

[
\hat{x}_{k+1}
=============

A_d \hat{x}*k
+
B_d u_k
+
B_w f*\theta(\tilde{y}_{k-N:k})
+
K_k \tilde{y}_k
]

This system is no longer linear because:

* (f_\theta(\cdot)) is nonlinear
* Hidden state evolves internally

The closed-loop stability depends on:

1. Bounded GRU output
2. Stability of (A_d - K C A_d)
3. Lipschitz continuity of GRU mapping

---

# 8. Innovation Whitening Interpretation

Define innovation autocovariance:

[
R_{\tilde{y}}(j)
================

E[\tilde{y}*k \tilde{y}*{k-j}^T]
]

In ideal KF:

[
R_{\tilde{y}}(j) = 0 \quad \forall j \neq 0
]

Hybrid objective is:

[
R_{\tilde{y}}^{hybrid}(j) \rightarrow 0
]

meaning GRU correction should whiten innovation by removing correlated disturbance components.

Thus hybrid training can also be framed as:

[
\min_\theta
\sum_{j=1}^M
||R_{\tilde{y}}(j)||_F^2
]

This interpretation gives strong theoretical grounding.

You are not just â€œestimating gustâ€.
You are enforcing innovation decorrelation.

That is powerful and mathematically elegant.

---

# 9. Interpretation as Augmented Nonlinear State Estimator

Your hybrid architecture effectively approximates the solution of:

[
\begin{bmatrix}
x_{k+1} \
g_{k+1}
\end{bmatrix}
=============

\mathcal{F}
\left(
\begin{bmatrix}
x_k \
g_k
\end{bmatrix},
u_k
\right)
]

without explicitly modeling gust dynamics.

GRU learns implicit disturbance evolution law.

KF maintains physical consistency of aircraft states.

Thus the system blends:

* Deterministic physics
* Learned disturbance evolution
* Statistical correction

This forms a structured nonlinear observer.

---

This now gives you deep theoretical grounding:

* Innovation analysis
* Error propagation
* Augmented hidden system
* Nonlinear observer interpretation
* Whitening condition
* Stability discussion

This is no longer just â€œapply GRUâ€.

This is a hybrid observer theory.

When youâ€™re ready, we can:

* Derive boundedness condition formally
* Or design Lyapunov-based stability argument
* Or derive computational complexity expressions

You choose the next depth.

